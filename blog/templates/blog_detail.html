{% extends 'base.html' %}

{% block content %}
  <article>
    <div class="row">
      <div class="col-8">
        <h1>{{ blog.title }}</h1>
        <img src="/media/{{ blog.image }}" class="card-img-top" width="350" height="400">
      </div>
    </div>
    <div>
      <p>{{ blog.content }}</p>
    </div>
  </article>
  
  <div class="row">
    <div class="col-4" offset-2>
      <h3>Comments</h3>
      {% if comments %}
        <ul class="comment-list">
          {% for comment in comments %}
            <li class="comment">
              <b>{{ comment.author }}</b>
              <p>{{ comment.text }}</p>
                <div class="row">
                  <div class="col-2">
                    <a href="{% url 'edit_comment' comment.id %}" class="btn btn-info">Edit</a>
                  </div>
                  <div class="col-2">
                    <form action="{% url 'delete_comment' comment.id %}" method="post">
                      {% csrf_token %}
                      <input type="hidden" name="confirmation_code" value="DELETE">
                      <input type="button" value="Delete comment" class="btn btn-danger" onclick="return confirm('Are you sure you want to delete this blog?')">
                    </form>
                  </div>
                </div>
            </li>
          {% endfor %}
        </ul>
      {% else %}
        <p>No comments yet.</p>
      {% endif %}
    
      <h3>Add a Comment</h3>
      <form method="post" action="{% url 'create_comment' blog.id %}">
        {% csrf_token %}
        {{ comment_form.as_p }}
        <button type="submit" class="btn btn-primary">Submit</button>
      </form>
    </div>
    <div class="col-6">
      <div class="row">
        <div class="col-3">
          {% with like_count=blog.get_like_count %}
          <form action="" method="post">
            {% csrf_token %}
            <input type="button" id="lsave" data-post-id="{{ blog.id }}" value="Like: " class="custom-button"></input><span id="tlik">{{ like_count }}</span>
          </form>
          {% endwith %}
        </div>
        <div class="col-3">
          {% with dislike_count=blog.get_dislike_count %}
            <form action="" method="post">
              {% csrf_token %}
              <input type="button" id="usave" data-post-id="{{ blog.id }}" value="Dislike:  " class="custom-button"></input><span id="dlik">{{ dislike_count }}</span>
            </form>
          {% endwith %}
        </div>
      </div>
    </div>
  </div>
  <a href="{% url 'index' %}" style="background-color: #FF5733; color: white;" class="btn mt-2">Back to the main page</a>
{% endblock content %}
